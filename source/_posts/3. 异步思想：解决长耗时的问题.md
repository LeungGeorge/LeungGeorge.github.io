---
tags:
  - 性能优化
  - 总结
  - blog
share: "true"
categories:
  - 系统优化
title: 异步思想：解决长耗时的问题
date: 2024-08-06,16:35
comments: true
---

## 异步思想：解决长耗时问题

异步思想是一种解决长耗时问题的方法，它通过将耗时的操作放在后台进行，不阻塞主线程或其他任务的执行，从而提高系统的响应性能和并发处理能力。

**业务场景：**

在处理一些复杂的业务场景时，对于部分操作考虑使用**异步**，可以大幅降低接口耗时。

比如，在做服务性能优化时，可以将如数据上报、流水日志等做异步处理，以降低接口时延。用户上传图片后的审核，音视频的合成等等。

**案例 1：**

以[文本配音（TTS）](https://kf.zenvideo.qq.com/help/doc?id=dcccf9045b50dca3)为例，【合成声音】和【编辑声音】这两个子过程耗耗时比较长。我们可以把耗时长的部分封装到一个异步任务中，并生成一个任务 ID，后续可以查询处理进度和结果。

音频生成部分改为异步任务是因为该子过程是文本配音的关键路径（主流程、耗时长），对非关键路径如【数据埋点】直接改为协程处理即可：

![](assets/images/864f476c0f863eb5f651ff080dc30a76_MD5.png)

异步思想是一种解决长耗时问题的方法，它通过将耗时的操作放在后台进行，不阻塞主线程或其他任务的执行，从而提高系统的响应性能和并发处理能力。

**案例 2：**

异步处理在数据库中同样应用广泛。例如  Redis  的 bgsave，bgrewriteof 就是分别用来异步保存 RDB 跟 AOF 文件的命令，bgsave 执行后会立刻返回成功，主线程 fork 出一个线程用来将内存中数据生成快照保存到磁盘，而主线程继续执行客户端命令。

需要注意的是：

- 异步并没有缩短整体的响应时间，反而可能有所增加；
- 异步主要是增加了吞吐量。

**一些常见的异步编程方式有：**

![](assets/images/38d2fb76c1e1baf507a3ac2d27c8a10b_MD5.png)
